{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";//ID: 1174261\n//Name: Buzz Kho\nimport React,{Component}from\"react\";import{CategoryNavBar}from\"../category/categoryNavBar/CategoryNavBar\";import{SearchBar}from\"../search/searchBar/SearchBar\";import\"../../common/hero/hero.css\";import{CartProductRow}from\"./CartProductRow\";import\"../../common/styles/common.css\";import{API}from\"aws-amplify\";import{Redirect}from\"react-router\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ShoppingCart=/*#__PURE__*/function(_Component){_inherits(ShoppingCart,_Component);var _super=_createSuper(ShoppingCart);function ShoppingCart(props){var _this;_classCallCheck(this,ShoppingCart);_this=_super.call(this,props);_this.getOrderTotal=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var ordersInCart,total;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.listOrdersInCart();case 2:ordersInCart=_context.sent;_this.setState({orders:ordersInCart});total=ordersInCart.reduce(function(total,book){return total+book.price*book.quantity;},0).toFixed(2);_this.setState({orderTotal:total});case 6:case\"end\":return _context.stop();}}},_callee);}));_this.onCheckout=function(){_this.setState({toCheckout:true});};_this.state={isLoading:true,orders:[],orderTotal:undefined,toCheckout:false};return _this;}_createClass(ShoppingCart,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var ordersInCart;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return this.listOrdersInCart();case 3:ordersInCart=_context2.sent;this.setState({orders:ordersInCart});_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);alert(_context2.t0);case 10:this.getOrderTotal();this.setState({isLoading:false});case 12:case\"end\":return _context2.stop();}}},_callee2,this,[[0,7]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"listOrdersInCart\",value:function listOrdersInCart(){return API.get(\"cart\",\"/cart\",null);}},{key:\"render\",value:function render(){var _this2=this;if(this.state.toCheckout)return/*#__PURE__*/_jsx(Redirect,{to:\"/checkout\"});return this.state.isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"loader\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"Category\",children:[/*#__PURE__*/_jsx(SearchBar,{}),/*#__PURE__*/_jsx(CategoryNavBar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"well-bs padding-bottom-120\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"white-box no-margin-top\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Shopping cart\"})}),this.state.orders.map(function(order){return/*#__PURE__*/_jsx(CartProductRow,{order:order,calculateTotal:function calculateTotal(){return _this2.getOrderTotal();}},order.bookId);}),/*#__PURE__*/_jsx(\"div\",{className:\"pull-right checkout-padding\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-black\",type:\"button\",disabled:this.state.orders.length<1,onClick:this.onCheckout,children:\"Checkout\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"well-bs col-md-12 full-page\"})]});}}]);return ShoppingCart;}(Component);export{ShoppingCart as default};","map":{"version":3,"sources":["C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/src/modules/cart/ShoppingCart.tsx"],"names":["React","Component","CategoryNavBar","SearchBar","CartProductRow","API","Redirect","ShoppingCart","props","getOrderTotal","listOrdersInCart","ordersInCart","setState","orders","total","reduce","book","price","quantity","toFixed","orderTotal","onCheckout","toCheckout","state","isLoading","undefined","alert","get","map","order","bookId","length"],"mappings":"y+BACA;AACA;AAEA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,cAAT,KAA+B,2CAA/B,CACA,OAASC,SAAT,KAA0B,+BAA1B,CACA,MAAO,4BAAP,CACA,OAASC,cAAT,KAAsC,kBAAtC,CACA,MAAO,gCAAP,CACA,OAASC,GAAT,KAAoB,aAApB,CACA,OAASC,QAAT,KAAyB,cAAzB,C,2FAWqBC,CAAAA,Y,4GACnB,sBAAYC,KAAZ,CAAsC,8CACpC,uBAAMA,KAAN,EADoC,MA6BtCC,aA7BsC,sEA6BtB,gLACa,OAAKC,gBAAL,EADb,QACRC,YADQ,eAEd,MAAKC,QAAL,CAAc,CACZC,MAAM,CAAEF,YADI,CAAd,EAIIG,KANU,CAMFH,YAAY,CAACI,MAAb,CAAoB,SAACD,KAAD,CAAgBE,IAAhB,CAAgC,CAC9D,MAAOF,CAAAA,KAAK,CAAGE,IAAI,CAACC,KAAL,CAAaD,IAAI,CAACE,QAAjC,CACD,CAFW,CAET,CAFS,EAENC,OAFM,CAEE,CAFF,CANE,CAUd,MAAKP,QAAL,CAAc,CACZQ,UAAU,CAAEN,KADA,CAAd,EAVc,sDA7BsB,SA4CtCO,UA5CsC,CA4CzB,UAAM,CACjB,MAAKT,QAAL,CAAc,CACZU,UAAU,CAAE,IADA,CAAd,EAGD,CAhDqC,CAGpC,MAAKC,KAAL,CAAa,CACXC,SAAS,CAAE,IADA,CAEXX,MAAM,CAAE,EAFG,CAGXO,UAAU,CAAEK,SAHD,CAIXH,UAAU,CAAE,KAJD,CAAb,CAHoC,aASrC,C,oJAED,iMAE+B,MAAKZ,gBAAL,EAF/B,QAEUC,YAFV,gBAGI,KAAKC,QAAL,CAAc,CACZC,MAAM,CAAEF,YADI,CAAd,EAHJ,mFAOIe,KAAK,cAAL,CAPJ,QAUE,KAAKjB,aAAL,GACA,KAAKG,QAAL,CAAc,CAAEY,SAAS,CAAE,KAAb,CAAd,EAXF,sE,6IAcA,2BAAmB,CACjB,MAAOnB,CAAAA,GAAG,CAACsB,GAAJ,CAAQ,MAAR,CAAgB,OAAhB,CAAyB,IAAzB,CAAP,CACD,C,sBAuBD,iBAAS,iBACP,GAAI,KAAKJ,KAAL,CAAWD,UAAf,CAA2B,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAC,WAAb,EAAP,CAE3B,MACE,MAAKC,KAAL,CAAWC,SAAX,cAAuB,YAAK,SAAS,CAAC,QAAf,EAAvB,cACA,aAAK,SAAS,CAAC,UAAf,wBACE,KAAC,SAAD,IADF,cAEE,KAAC,cAAD,IAFF,cAGE,aAAK,SAAS,CAAC,4BAAf,wBACI,YAAK,SAAS,CAAC,yBAAf,uBACA,qCADA,EADJ,CAIG,KAAKD,KAAL,CAAWV,MAAX,CAAkBe,GAAlB,CAAsB,SAAAC,KAAK,qBAAI,KAAC,cAAD,EAAgB,KAAK,CAAEA,KAAvB,CAAiD,cAAc,CAAE,gCAAM,CAAA,MAAI,CAACpB,aAAL,EAAN,EAAjE,EAAmCoB,KAAK,CAACC,MAAzC,CAAJ,EAA3B,CAJH,cAKI,YAAK,SAAS,CAAC,6BAAf,uBACE,eAAQ,SAAS,CAAC,eAAlB,CAAkC,IAAI,CAAC,QAAvC,CAAgD,QAAQ,CAAE,KAAKP,KAAL,CAAWV,MAAX,CAAkBkB,MAAlB,CAA2B,CAArF,CAAwF,OAAO,CAAE,KAAKV,UAAtG,sBADF,EALJ,GAHF,cAYI,YAAK,SAAS,CAAC,6BAAf,EAZJ,GAFF,CAiBD,C,0BAvEuCpB,S,SAArBM,Y","sourcesContent":["\r\n//ID: 1174261\r\n//Name: Buzz Kho\r\n\r\nimport React, { Component } from \"react\";\r\nimport { CategoryNavBar } from \"../category/categoryNavBar/CategoryNavBar\";\r\nimport { SearchBar } from \"../search/searchBar/SearchBar\";\r\nimport \"../../common/hero/hero.css\";\r\nimport { CartProductRow, Order } from \"./CartProductRow\";\r\nimport \"../../common/styles/common.css\";\r\nimport { API } from \"aws-amplify\";\r\nimport { Redirect } from \"react-router\";\r\n\r\ninterface ShoppingCartProps {}\r\n\r\ninterface ShoppingCartState {\r\n  isLoading: boolean;\r\n  orders: any[]; // FIXME\r\n  orderTotal: number | undefined;\r\n  toCheckout: boolean;\r\n}\r\n\r\nexport default class ShoppingCart extends Component<ShoppingCartProps, ShoppingCartState> {\r\n  constructor(props: ShoppingCartProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      isLoading: true,\r\n      orders: [],\r\n      orderTotal: undefined,\r\n      toCheckout: false\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    try {\r\n      const ordersInCart = await this.listOrdersInCart();\r\n      this.setState({ \r\n        orders: ordersInCart,\r\n      });\r\n    } catch (e) {\r\n      alert(e);\r\n    }\r\n\r\n    this.getOrderTotal();\r\n    this.setState({ isLoading: false });\r\n  }\r\n\r\n  listOrdersInCart() {\r\n    return API.get(\"cart\", \"/cart\", null);\r\n  }\r\n\r\n  getOrderTotal = async () => {\r\n    const ordersInCart = await this.listOrdersInCart();\r\n    this.setState({\r\n      orders: ordersInCart,\r\n    });\r\n\r\n    let total = ordersInCart.reduce((total: number, book: Order) => {\r\n      return total + book.price * book.quantity\r\n    }, 0).toFixed(2);\r\n\r\n    this.setState({\r\n      orderTotal: total\r\n    });\r\n  }\r\n\r\n  onCheckout = () => {\r\n    this.setState({\r\n      toCheckout: true\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.toCheckout) return <Redirect to='/checkout' />\r\n\r\n    return (\r\n      this.state.isLoading ? <div className=\"loader\"></div> :\r\n      <div className=\"Category\">\r\n        <SearchBar />\r\n        <CategoryNavBar />\r\n        <div className=\"well-bs padding-bottom-120\">\r\n            <div className=\"white-box no-margin-top\">\r\n            <h3>Shopping cart</h3>\r\n          </div>\r\n          {this.state.orders.map(order => <CartProductRow order={order} key={order.bookId} calculateTotal={() => this.getOrderTotal()} />)}\r\n            <div className=\"pull-right checkout-padding\">\r\n              <button className=\"btn btn-black\" type=\"button\" disabled={this.state.orders.length < 1} onClick={this.onCheckout}>Checkout</button>\r\n            </div>\r\n          </div>\r\n          <div className=\"well-bs col-md-12 full-page\"></div>\r\n        </div>\r\n    );\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}