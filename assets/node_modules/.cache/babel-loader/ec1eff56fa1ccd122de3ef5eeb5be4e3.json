{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";//ID: 1174261\n//Name: Buzz Kho\nimport React,{Component}from\"react\";import{CategoryNavBar}from\"../category/categoryNavBar/CategoryNavBar\";import{SearchBar}from\"../search/searchBar/SearchBar\";import\"../../common/hero/hero.css\";import{PurchasedProductRow}from\"./PurchasedProductRow\";import{Auth,API}from\"aws-amplify\";import bestSellers from\"../../images/bestSellers.png\";import yourshoppingcart from\"../../images/yourshoppingcart.png\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PastPurchases=/*#__PURE__*/function(_Component){_inherits(PastPurchases,_Component);var _super=_createSuper(PastPurchases);function PastPurchases(props){var _this;_classCallCheck(this,PastPurchases);_this=_super.call(this,props);_this.getPrettyDate=function(orderDate){var date=new Date(orderDate);return\"\".concat(date.getMonth(),\"/\").concat(date.getDate(),\"/\").concat(date.getFullYear(),\" \").concat(date.getHours(),\":\").concat(date.getMinutes()<10?'0':'').concat(date.getMinutes());};_this.state={userInfo:null,isLoading:true,orders:[]};return _this;}_createClass(PastPurchases,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userInfo,orders;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Auth.currentUserInfo();case 2:userInfo=_context.sent;this.setState({userInfo:userInfo});_context.prev=4;_context.next=7;return this.listOrders();case 7:orders=_context.sent;this.setState({orders:orders,isLoading:false});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](4);alert(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,this,[[4,11]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"listOrders\",value:function listOrders(){return API.get(\"orders\",\"/orders\",null);}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{className:\"Category\",children:[/*#__PURE__*/_jsx(SearchBar,{}),/*#__PURE__*/_jsx(CategoryNavBar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"well-bs col-md-12\",children:[this.state.userInfo&&/*#__PURE__*/_jsx(\"div\",{className:\"white-box no-margin-top\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Hello \".concat(this.state.userInfo.attributes.email,\"!\")})}),/*#__PURE__*/_jsx(\"div\",{className:\"white-box\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Past purchases\"})}),!this.state.isLoading&&this.state.orders&&this.state.orders.sort(function(order1,order2){return order2.orderDate-order1.orderDate;}).map(function(order){return/*#__PURE__*/_jsxs(\"div\",{className:\"order-date\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Order date: \".concat(_this2.getPrettyDate(order.orderDate))}),order.books.map(function(book){return/*#__PURE__*/_jsx(PurchasedProductRow,{order:book},book.bookId);})]},order.orderId);}),/*#__PURE__*/_jsxs(\"div\",{className:\"well-bs no-margin-top no-padding col-md-12\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/best\",children:/*#__PURE__*/_jsx(\"img\",{src:bestSellers,alt:\"Best sellers\",className:\"checkout-img no-padding\"})}),/*#__PURE__*/_jsx(\"a\",{href:\"/cart\",children:/*#__PURE__*/_jsx(\"img\",{src:yourshoppingcart,alt:\"Shopping cart\",className:\"checkout-img no-padding\"})})]})]})]});}}]);return PastPurchases;}(Component);export{PastPurchases as default};","map":{"version":3,"sources":["C:/Users/Buzz/Desktop/aws-bookstore-demo-app/assets/src/modules/pastPurchases/PastPurchases.tsx"],"names":["React","Component","CategoryNavBar","SearchBar","PurchasedProductRow","Auth","API","bestSellers","yourshoppingcart","PastPurchases","props","getPrettyDate","orderDate","date","Date","getMonth","getDate","getFullYear","getHours","getMinutes","state","userInfo","isLoading","orders","currentUserInfo","setState","listOrders","alert","get","attributes","email","sort","order1","order2","map","order","books","book","bookId","orderId"],"mappings":"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","sourcesContent":["//ID: 1174261\r\n//Name: Buzz Kho\r\n\r\nimport React, { Component } from \"react\";\r\nimport { CategoryNavBar } from \"../category/categoryNavBar/CategoryNavBar\";\r\nimport { SearchBar } from \"../search/searchBar/SearchBar\";\r\nimport \"../../common/hero/hero.css\";\r\nimport { PurchasedProductRow } from \"./PurchasedProductRow\";\r\nimport { Auth, API } from \"aws-amplify\";\r\nimport bestSellers from \"../../images/bestSellers.png\";\r\nimport yourshoppingcart from \"../../images/yourshoppingcart.png\";\r\nimport { Order } from \"../cart/CartProductRow\";\r\n\r\ninterface PastPurchasesProps {}\r\n\r\ninterface Purchases {\r\n  orderDate: number;\r\n  orderId: string;\r\n  books: Order[];\r\n}\r\n\r\ninterface PastPurchasesState {\r\n  userInfo: any; // FIXME\r\n  isLoading: boolean;\r\n  orders: Purchases[];\r\n}\r\n\r\nexport default class PastPurchases extends Component<PastPurchasesProps, PastPurchasesState> {\r\n  constructor(props: PastPurchasesProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      userInfo: null,\r\n      isLoading: true,\r\n      orders: []\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const userInfo = await Auth.currentUserInfo();\r\n    this.setState({ userInfo })\r\n\r\n    try {\r\n      const orders = await this.listOrders();\r\n      this.setState({ \r\n        orders: orders,\r\n        isLoading: false\r\n     });\r\n    } catch (e) {\r\n      alert(e);\r\n    }\r\n  }\r\n\r\n  listOrders() {\r\n    return API.get(\"orders\", \"/orders\", null);\r\n  }\r\n\r\n  getPrettyDate = (orderDate: number) => {\r\n    const date = new Date(orderDate);\r\n    return `${date.getMonth()}/${date.getDate()}/${date.getFullYear()} ${date.getHours()}:${date.getMinutes() < 10 ? '0' : ''}${date.getMinutes()}`\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"Category\">\r\n        <SearchBar />\r\n        <CategoryNavBar />\r\n        <div className=\"well-bs col-md-12\">\r\n          {this.state.userInfo && <div className=\"white-box no-margin-top\">\r\n            <h3>{`Hello ${this.state.userInfo.attributes.email}!`}</h3>\r\n          </div>}\r\n          <div className=\"white-box\">\r\n            <h3>Past purchases</h3>\r\n          </div>\r\n          {!this.state.isLoading && this.state.orders && this.state.orders\r\n            .sort((order1, order2) => order2.orderDate - order1.orderDate)\r\n            .map(order => \r\n              <div className=\"order-date\" key={order.orderId}>\r\n                <h4>{`Order date: ${this.getPrettyDate(order.orderDate)}`}</h4>\r\n                {order.books.map((book) => <PurchasedProductRow order={book} key={book.bookId} />)}\r\n              </div>)\r\n          }\r\n          \r\n          <div className=\"well-bs no-margin-top no-padding col-md-12\">\r\n          <a href=\"/best\"><img src={bestSellers} alt=\"Best sellers\" className=\"checkout-img no-padding\" /></a>\r\n          <a href=\"/cart\"><img src={yourshoppingcart} alt=\"Shopping cart\" className=\"checkout-img no-padding\" /></a>\r\n          \r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}